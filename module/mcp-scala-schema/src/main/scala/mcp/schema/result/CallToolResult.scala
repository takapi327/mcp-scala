/**
 * Copyright (c) 2025-2026 by Takahiko Tominaga
 * This software is licensed under the MIT License (MIT).
 * For more information see LICENSE or https://opensource.org/licenses/MIT
 */

package mcp.schema
package result

import io.circe.*

/**
 * The server's response to a tool call.
 *
 * Any errors that originate from the tool SHOULD be reported inside the result
 * object, with `isError` set to true, _not_ as an MCP protocol-level error
 * response. Otherwise, the LLM would not be able to see that an error occurred
 * and self-correct.
 *
 * However, any errors in _finding_ the tool, an error indicating that the
 * server does not support tool calls, or any other exceptional conditions,
 * should be reported as an MCP error response.
 */
final case class CallToolResult(
  content: List[Content],
  isError: Option[Boolean]
) extends Result

object CallToolResult:
  given Decoder[CallToolResult] = Decoder.derived[CallToolResult]
  given Encoder[CallToolResult] = Encoder.derived[CallToolResult].mapJson(_.dropNullValues)
